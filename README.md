# Vulnerability Management

## Objective

A comprehensive vulnerability management project aimed at identifying, assessing, and remediating vulnerabilities for a client. This involves regular scanning, detailed analysis, and vulnerability prioritization, as well as implementing remediation. Findings and remediation efforts are documented to improve the client's security posture.

### Skills Learned

- Proficiency in using vulnerability scanning tools: Nessus.
- Evaluate and prioritize vulnerabilities based on risk assessment criteria.
- Develop and implement remediation strategies.
- Create detailed reports on vulnerability findings and remediation steps.
- Effectually communicate findings and recommendations to stakeholders.
- Understand system configurations and network architectures.
- Analyzing vulnerability scan results and investigate root causes.
- Troubleshooting issues that arising from scans and subsequent research

### Tools Used

- Metasploit: To exploit vulnerabilities and validate remediation.
- Metasploitable: A deliberately vulnerable environment for testing.
- Nessus: To scan and identify vulnerabilities within the environment.

## Steps
1. After installing Nessus start a new scan and enter the name, a description, and your target (either a specific IP or a range/list of IP addresses in a file).<br>
  ![choosing basic network scan](https://github.com/user-attachments/assets/196bb0c0-c680-4362-909e-1c9b9d95a947)<br>
  *Ref1: Vulnerability Scan*
2. When the scan completes check it's results. One can see the description of the vulnerabilities and a severity rating. Generate a report with the report button and choose "Complete list of vulberavilities by Host"<br>
  ![Generate report](https://github.com/user-attachments/assets/8f99d1e6-f9f0-4954-918a-34bf5a48bbbc)<br>
  *Ref2: Vulnerability Report*
3. Once comfortable with the contents of the report, install and run metasploit (framework installed in Kali) and metasploitable in the same network as your machine running Nessus.<br>
  ![metasploit console](https://github.com/user-attachments/assets/66d90414-d22e-4678-a661-de68babe1b6c)<br>
  *Ref3: Metaploit*<br>
   ![metasploitable 2 VM](https://github.com/user-attachments/assets/e1d525c9-832d-4766-af75-c42175c5ef74)<br>
   *Ref4:<a href="https://docs.rapid7.com/metasploit/metasploitable-2/"> Metasploitable 2</a>*
4. For testing metasploit is used to run an exploit on the target system. In Kali Linux terminal spin up metasploit console with [msfconsole]. Using [search vsftpd] to search for the specific exploit, using the xploit with [use exploit/unix/ftp/vsftpd_234_backdoor].       [show options] will show what is necessary to run the exploit. Set the host machine to the target with [set RHOST <ip of target>] and then enter [run] into the console.
5. Going to our machine running Nessus, run a new scan on the metasploitable vm.<br>
   ![metasploitable nessus scan](https://github.com/user-attachments/assets/d1fac959-8059-4acb-8289-3c37c05a5d64)<br>
   *Ref5: Nessus Scan*
6. The scan results show the number of vulnerabilities, Severity rating, CVSS, VPR score, etc...<br>
  ![nessus scan results](https://github.com/user-attachments/assets/ba949bd4-d2e4-4bc3-ba2a-903a22ce394f)
7. Clicking on a single vulnerability gives more insight. Severity, Description, a Sloution, and other relevant information is displayed for further action. 66 vulnerabilities were identified fro the client on the target system.<br>
  ![nessus scan vulnerability](https://github.com/user-attachments/assets/d04dd2c8-a6e5-487f-8914-02f205a9280b)<br>
   *Ref6: Nessus vulnerability*<br>
8. For a comprehensive report to aid in analysis and remediation click on the report button (as described above).<br>
  ![Nessus vulnerability report](https://github.com/user-attachments/assets/f7377613-b389-4cb0-9eb6-c34753d69ae5).
### <ins>Analysis</ins><br>
  ![Apache critical 10 0](https://github.com/user-attachments/assets/279d70a1-bb34-47eb-982a-f6ecca67a770)<br>
  *Ref7: Apache CVSS 10.0*<br>
-Apache Tomcat (Critical, CVSS 10.0):
  Description: Unsupported version, no new security patches.
  Remediation: Upgrade to a supported version from tomcat.apache.org.
  ![ISC BIND DOS High 8 6](https://github.com/user-attachments/assets/628b4c6f-f337-455e-8b50-63d058f517b2)<br>
  *Ref8: DoS vuln. 8.6*<br>
  Next vulnerability to highlight is the ISC BIND Service Downgrade / Reflected DoS, which affects the remote name server with Service Downgrade / Reflected DoS vulnerabilities. The affect of performance downgrade and Reflected DoS vulnerabilities is due to BIND DNS not adequately limiting the number fetches which may be performed while processing a refferal response. An unauthenticated, remote attacker could exploit this to cause degredation in the service of the recursive server or use the affected server as a reflector in a reflected attack. To remediate this issue upgrade the ISC BIND version from isc.org/download.
  ![SSL cert medium 6 5](https://github.com/user-attachments/assets/7344be82-ad8c-4f32-8696-4833e518261a)<br>
  *Ref9: SSL cert 6.5*<br>
  SSL Certificate Cannot Be Trusted is a 6.5 medium severity vulnerability. The certificate is designated as untrusted as the server's X.509's certificate cannot be trusted. That is to say one of these three situations have broken the chain of trust. The first possibility being that the top of the certificate chain sent by the server might not have been descended from a known public CA. This could occur either when the top of the chain is an unrecognized, self-signed certificate, or when intermediate certificates are missing that would connect it to a known public CA. Second possibility could be that the cahin of trust may contain a certificate that is not valid at the time of the scan. When a scan is ran before a certificates "notBefore" or after it's "notAfter" dates, this vulnerability is flagged. Third, the certificate chain may contain a signature that either did not match the certificate's information or could not be verified. Now bad signatures can be fixed by getting the certificate with the bad signature re-signed by it's issuer. Signatures that could not be verified are the result of the certificate's issuer using a signing algorithm that the scanner, this time Nessus, either does not support or does not recognize. If the remote host is public, any break in the chain will make it more difficult to veriy auntenticity and identity of the web server, making it easier to carry out a man-in-the-middle attack against the the remote host. The solution is fairly easy the SSL certificate for the server just needs to be purchased or generated properly.<br>
![DHE 3 7](https://github.com/user-attachments/assets/f6f29931-4590-4e7c-a0b4-aed4832f5c71)<br>
*Redf10: DHE 3.7*<br>
This low severity vulnerability means that the remote host allows a SSL/TLS connections with one or more Diffie-Hellman moduli <= 1024 bits. If a third unwanted party used cryptanalysis they may be able to find the shared secret in a short amount of time, also allowing an attacker to recover the plaintext or violate the integrity of a connection. This can be remediated by reconfiguring the service to use a unique Diffie-Hellman moduli of 2048 bits or greater.
